(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{30:function(e,t,n){},39:function(e,t,n){},59:function(e,t,n){},65:function(e,t,n){},66:function(e,t,n){},67:function(e,t,n){},68:function(e,t,n){},69:function(e,t,n){},70:function(e,t,n){},71:function(e,t,n){"use strict";n.r(t);var s=n(0),c=n(1),a=n(31),r=n.n(a),o=(n(39),n(5)),i=n.n(o),u=n(2),l=n.n(u),j=n(7),b=n(3),p="https://image-share-backend.herokuapp.com",d=Object(c.createContext)();function h(e){var t=Object(c.useState)(void 0),n=Object(b.a)(t,2),a=n[0],r=n[1];function o(){return u.apply(this,arguments)}function u(){return(u=Object(j.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.get(p+"/user/loggedIn");case 2:t=e.sent,r(t.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(c.useEffect)((function(){o()}),[]),Object(s.jsx)(d.Provider,{value:{user:a,getUser:o},children:e.children})}var m=d,O=n(9),f=n(4);n(59);var x=function(){var e=Object(c.useContext)(m).user,t=Object(f.f)();function n(){return(n=Object(j.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.get(p+"/user/loggedOut");case 2:t.push("/login");case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.jsxs)("div",{className:"navbar",children:[Object(s.jsx)("div",{className:"logo",children:Object(s.jsx)("a",{href:"/",children:Object(s.jsx)("h1",{children:"Home"})})}),e?Object(s.jsx)("button",{onClick:function(){return n.apply(this,arguments)},style:{color:"red",cursor:"pointer"},children:"Log Out"}):Object(s.jsxs)("div",{className:"auths",children:[Object(s.jsx)(O.b,{to:"/login",children:Object(s.jsx)("h2",{children:"Login"})}),Object(s.jsx)(O.b,{to:"/register",children:Object(s.jsx)("h2",{children:"Register"})})]})]})},v=n(33);n(65),n(66);var g=function(e){return Object(s.jsx)("div",{className:"indi-comment",children:Object(s.jsxs)("div",{className:"comment-box",children:[Object(s.jsxs)("div",{className:"comment-by",children:[e.comment.email," said:"]}),Object(s.jsx)("div",{className:"comment-container",children:e.comment.comment})]})})};var k=function(e){var t=Object(c.useState)([]),n=Object(b.a)(t,2),a=n[0],r=n[1],o=e.user,u=Object(c.useState)(""),d=Object(b.a)(u,2),h=d[0],m=d[1],f=Object(c.useState)("btn-not-like"),x=Object(b.a)(f,2),v=x[0],k=x[1],y=Object(c.useState)(e.post.likes.length),w=Object(b.a)(y,2),N=w[0],C=w[1];function S(){return P.apply(this,arguments)}function P(){return(P=Object(j.a)(l.a.mark((function t(){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.a.get(p+"/comments/"+e.post._id);case 2:return n=t.sent,t.t0=e.post.likes,t.next=6,o.userId;case 6:if(t.t1=t.sent,!t.t0.includes.call(t.t0,t.t1)){t.next=9;break}k("btn-like");case 9:r(n.data);case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function D(){return(D=Object(j.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.a.delete(p+"/posts/"+e.post._id);case 2:e.getPosts();case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function L(){return(L=Object(j.a)(l.a.mark((function t(){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return m(""),n={comment:h,postId:e.post._id},t.next=4,i.a.post(p+"/comments/"+e.post._id,n).then((function(e){return console.log(e)}));case 4:S();case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function I(){return(I=Object(j.a)(l.a.mark((function t(){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n={postId:e.post._id,userId:o.userId},"btn-not-like"!==v){t.next=9;break}return k("btn-like"),t.next=5,i.a.put(p+"/posts/like",n);case 5:e.getPosts(),C(N+1),t.next=15;break;case 9:if("btn-like"!==v){t.next=15;break}return k("btn-not-like"),t.next=13,i.a.put(p+"/posts/unlike",n);case 13:e.getPosts(),C(N-1);case 15:case 16:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(c.useEffect)((function(){o&&S()}),[]),Object(s.jsxs)("div",{className:"post",children:[Object(s.jsxs)("div",{className:"left",children:[e.post.email&&Object(s.jsx)("h2",{className:"name",children:Object(s.jsx)(O.b,{to:"#",children:e.post.email})}),Object(s.jsx)("img",{className:"image",src:p+"/"+e.post.postImage,height:"400",width:"300"}),o&&Object(s.jsxs)("button",{className:v,onClick:function(){return I.apply(this,arguments)},children:["Likes :",N]}),e.post.desc&&Object(s.jsx)("h2",{className:"desc",children:e.post.desc}),e.defaultUrl!==p+"/posts/"&&Object(s.jsx)("button",{className:"btn-delete",onClick:function(){return D.apply(this,arguments)},children:"Delete Post"})]}),Object(s.jsxs)("div",{className:"right",children:[Object(s.jsxs)("div",{className:"comments",children:["Comments",a.map((function(e,t){return Object(s.jsx)(g,{comment:e,getComments:S,user:o},t)}))]}),o&&Object(s.jsxs)("div",{className:"add-comments",children:["Add Comments",Object(s.jsx)("textarea",{className:"comment-input",onChange:function(e){m(e.target.value)},value:h}),Object(s.jsx)("button",{className:"btn-comment",onClick:function(){return L.apply(this,arguments)},children:"Post Comment"})]})]})]})};n(67);var y=function(e){var t=Object(c.useState)(""),n=Object(b.a)(t,2),a=n[0],r=n[1],o=Object(c.useState)(void 0),u=Object(b.a)(o,2),d=u[0],h=u[1];return Object(s.jsxs)("div",{className:"post-editor",children:[Object(s.jsxs)("form",{onSubmit:m,children:[Object(s.jsx)("textarea",{id:"editor-description",type:"text",placeholder:"Enter some description here",value:a,onChange:function(e){return r(e.target.value)}}),Object(s.jsx)("input",{id:"editor-upload",type:"file",onChange:function(e){console.log(e.target.files[0]),h(e.target.files[0])}})]}),Object(s.jsx)("button",{className:"btn-upload",type:"submit",onClick:m,children:"Upload Post"}),Object(s.jsx)("button",{className:"btn-cancel",type:"button",onClick:f,children:"Cancel"})]});function m(e){return O.apply(this,arguments)}function O(){return(O=Object(j.a)(l.a.mark((function t(n){var s;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),(s=new FormData).append("desc",a),s.append("postImage",d),console.log(s),t.next=7,i.a.post(p+"/posts/",s).then((function(e){return console.log(e)}));case 7:e.getPosts(),f();case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function f(){e.setNewPostUploaderOpen(!1),r(""),h(void 0)}};n(68);var w=function(){var e=Object(c.useContext)(m).user,t=Object(c.useState)((new Date).toLocaleDateString()+" "+(new Date).toLocaleTimeString()),n=Object(b.a)(t,2),a=n[0],r=n[1],o=Object(c.useState)("https://image-share-backend.herokuapp.com/posts/"),u=Object(b.a)(o,2),d=u[0],h=u[1],f=Object(c.useState)([]),x=Object(b.a)(f,2),g=x[0],w=x[1],N=Object(c.useState)(!1),C=Object(b.a)(N,2),S=C[0],P=C[1],D=Object(c.useState)(null),L=Object(b.a)(D,2),I=L[0],U=L[1];function A(){h(p+"/user?email="+e.email)}function E(){return _.apply(this,arguments)}function _(){return(_=Object(j.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.get(d);case 2:t=e.sent,console.log(t.data),w(t.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e){U(e)}return setTimeout((function(){r((new Date).toLocaleDateString()+" "+(new Date).toLocaleTimeString())}),1e3),Object(c.useEffect)((function(){E()}),[d]),Object(s.jsxs)("div",{className:"home",children:[e?Object(s.jsxs)("div",{className:"current-user",children:[Object(s.jsxs)("div",{children:["Welcome ",e.email]}),Object(s.jsx)("div",{children:a})]}):Object(s.jsxs)("div",{className:"current-user",children:["Please ",Object(s.jsx)(O.b,{to:"/login",children:"Log-in"})," to like and comment"]}),!S&&e&&Object(s.jsx)("button",{className:"btn-add-post",onClick:function(){return P(!0)},children:"Add Post"}),e&&Object(s.jsx)("button",{className:"btn-my-post",onClick:A,children:"My Posts"}),S&&Object(s.jsx)(y,{setNewPostUploaderOpen:P,getPosts:E,editPostData:I}),function(){var t=Object(v.a)(g);return(t=t.sort((function(e,t){return new Date(t.createdAt)-new Date(e.createdAt)}))).map((function(t,n){return Object(s.jsx)(k,{post:t,defaultUrl:d,getPosts:E,editPost:R,user:e,myPosts:A,setMyPosts:h},n)}))}()]})};n(69);var N=function(e){return Object(s.jsxs)("div",{className:"msg-error",children:[e.message," ",Object(s.jsx)("button",{onClick:e.clear,children:"Clear"})]})};n(30);var C=function(){var e=Object(c.useState)(""),t=Object(b.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(""),o=Object(b.a)(r,2),u=o[0],d=o[1],h=Object(c.useState)(null),m=Object(b.a)(h,2),x=m[0],v=m[1],g=Object(f.f)();function k(){return(k=Object(j.a)(l.a.mark((function e(t){var s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),s={email:n,password:u},e.prev=2,e.next=5,i.a.post(p+"/user/signup",s);case 5:e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(2),e.t0.response&&e.t0.response.data.message&&v(e.t0.response.data.message),e.abrupt("return",console.log({err:e.t0}));case 11:g.push("/login");case 13:case"end":return e.stop()}}),e,null,[[2,7]])})))).apply(this,arguments)}return Object(s.jsxs)("div",{className:"auth-form",children:[Object(s.jsx)("h2",{children:"Register"}),x&&Object(s.jsx)(N,{message:x,clear:function(){return v(null)}}),Object(s.jsxs)("form",{className:"form",onSubmit:function(e){return k.apply(this,arguments)},children:[Object(s.jsx)("input",{type:"email",placeholder:"enter your email here",value:n,onChange:function(e){return a(e.target.value)}}),Object(s.jsx)("input",{type:"password",placeholder:"set a password",value:u,onChange:function(e){return d(e.target.value)}}),Object(s.jsx)("button",{className:"btn-action",type:"submit",children:"Register"})]}),Object(s.jsxs)("p",{children:["Already Have an account ? ",Object(s.jsx)(O.b,{to:"/login",children:"Login here"})," "]})]})};var S=function(){var e=Object(c.useState)(""),t=Object(b.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(""),o=Object(b.a)(r,2),u=o[0],d=o[1],h=Object(f.f)(),x=Object(c.useContext)(m).getUser,v=Object(c.useState)(null),g=Object(b.a)(v,2),k=g[0],y=g[1];function w(){return(w=Object(j.a)(l.a.mark((function e(t){var s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),s={email:n,password:u},e.prev=2,e.next=5,i.a.post(p+"/user/login",s);case 5:e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(2),e.t0.response&&e.t0.response.data.message&&y(e.t0.response.data.message),e.abrupt("return",console.log({err:e.t0}));case 11:return e.next=14,x();case 14:h.push("/");case 15:case"end":return e.stop()}}),e,null,[[2,7]])})))).apply(this,arguments)}return Object(s.jsxs)("div",{className:"auth-form",children:[Object(s.jsx)("h2",{children:"Login"}),k&&Object(s.jsx)(N,{message:k,clear:function(){return y(null)}}),Object(s.jsxs)("form",{className:"form",onSubmit:function(e){return w.apply(this,arguments)},children:[Object(s.jsx)("input",{type:"email",placeholder:"enter your email here",value:n,onChange:function(e){return a(e.target.value)}}),Object(s.jsx)("input",{type:"password",placeholder:"enter password",value:u,onChange:function(e){return d(e.target.value)}}),Object(s.jsx)("button",{className:"btn-action",type:"submit",children:"Log In"})]}),Object(s.jsxs)("p",{children:["Don't have an account ? ",Object(s.jsx)(O.b,{to:"/register",children:"Sign up here !"})," "]})]})};var P=function(){return Object(s.jsxs)(O.a,{children:[Object(s.jsx)(x,{}),Object(s.jsxs)(f.c,{children:[Object(s.jsx)(f.a,{exact:!0,path:"/",children:Object(s.jsx)(w,{})}),Object(s.jsx)(f.a,{path:"/login",children:Object(s.jsx)(S,{})}),Object(s.jsx)(f.a,{path:"/register",children:Object(s.jsx)(C,{})})]})]})};n(70);i.a.defaults.withCredentials=!0;var D=function(){return Object(s.jsx)(h,{children:Object(s.jsx)("div",{className:"container",children:Object(s.jsx)(P,{})})})};r.a.render(Object(s.jsx)(D,{}),document.getElementById("root"))}},[[71,1,2]]]);
//# sourceMappingURL=main.c694f4a6.chunk.js.map